<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>TMemoryStream.Truncate</title>
<link rel="stylesheet" href="../fpdoc.css" type="text/css">

</head>
<body>
<table class="bar" width="100%" border="0" cellpadding="4" cellspacing="0">
<tr>
<td><b>[<a href="../objects/index.html">Overview</a>][<a href="../objects/index-2.html">Constants</a>][<a href="../objects/index-3.html">Types</a>][<a href="../objects/index-4.html">Classes</a>][<a href="../objects/index-5.html">Procedures and functions</a>][<a href="../objects/index-6.html">Variables</a>][<a href="../objects/index-8.html">Index</a>]</b></td>
<td align="right"><span class="bartitle">Reference for unit 'Objects' (<a href="../index.html">#rtl</a>)</span></td>
</tr>
</table>
<h1>TMemoryStream.Truncate</h1>
<p>Set the stream size to the current position.</p>
<h2>Declaration</h2>
<p>Source position: objects.pp line 377</p>
<table cellpadding="0" cellspacing="0">
<tr>
<td><p><tt><span class="code">  <span class="kw">procedure</span> <a href="../objects/tmemorystream.html">TMemoryStream</a><span class="sym">.</span>Truncate<span class="sym">;</span><span class="kw"> virtual</span><span class="sym">;</span></span></tt></p></td>
</tr>
</table>
<h2>Description</h2>
<p><var>Truncate</var> sets the size of the memory stream equal to the current position. It de-allocates any memory-blocks that are no longer needed, so that the new size of the stream is the current position in the stream, rounded up to the first multiple of the stream blocksize. </p>
<h2>Errors</h2>
<p>If an error occurs during memory de-allocation, the stream's status is set to <var>stError</var></p>
<h2>See also</h2>
<table cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><p><a href="../objects/tstream.truncate.html">TStream.Truncate</a></p></td>
<td><p>&nbsp;&nbsp;</p></td>
<td><p class="cmt">Truncate the stream size on current position.</p></td>
</tr>
</table>
<h2>Example</h2>
<pre><span class="kw">Program</span> ex20<span class="sym">;</span>

<span class="cmt">{ Program to demonstrate the TMemoryStream.Truncate method }</span>

<span class="kw">Uses</span> Objects<span class="sym">;</span>

<span class="kw">Var</span> L <span class="sym">:</span> String<span class="sym">;</span>
    P <span class="sym">:</span> PString<span class="sym">;</span>
    S <span class="sym">:</span> PMemoryStream<span class="sym">;</span>
    I <span class="sym">:</span> Longint<span class="sym">;</span>

<span class="kw">begin</span>
  L<span class="sym">:=</span><span class="str">'Some constant string'</span><span class="sym">;</span>
  <span class="cmt">{ Buffer size of 100 }</span>
  S<span class="sym">:=</span>New<span class="sym">(</span>PMemoryStream<span class="sym">,</span>Init<span class="sym">(</span><span class="num">1000</span><span class="sym">,</span><span class="num">100</span><span class="sym">)</span><span class="sym">)</span><span class="sym">;</span>
  Writeln <span class="sym">(</span><span class="str">'Writing 100 times "'</span><span class="sym">,</span>L<span class="sym">,</span><span class="str">'" to stream.'</span><span class="sym">)</span><span class="sym">;</span>
  <span class="kw">For</span> I<span class="sym">:=</span><span class="num">1</span> to <span class="num">100</span> <span class="kw">do</span>
    S<span class="sym">^</span><span class="sym">.</span>WriteStr<span class="sym">(</span><span class="sym">@</span>L<span class="sym">)</span><span class="sym">;</span>
  Writeln <span class="sym">(</span><span class="str">'Finished.'</span><span class="sym">)</span><span class="sym">;</span>
  S<span class="sym">^</span><span class="sym">.</span>Seek<span class="sym">(</span><span class="num">100</span><span class="sym">)</span><span class="sym">;</span>
  S<span class="sym">^</span><span class="sym">.</span>Truncate<span class="sym">;</span>
  Writeln <span class="sym">(</span><span class="str">'Truncated at byte 100.'</span><span class="sym">)</span><span class="sym">;</span>
  Dispose <span class="sym">(</span>S<span class="sym">,</span>Done<span class="sym">)</span><span class="sym">;</span>
  Writeln <span class="sym">(</span><span class="str">'Finished.'</span><span class="sym">)</span><span class="sym">;</span>
<span class="kw">end</span><span class="sym">.</span>
</pre>
<hr>

<span class="footer">Documentation generated on: Sep 28 2017</span>
</body>
</html>
