<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Memavail and Maxavail</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,4,png,sections+,fn-in --> 
<meta name="src" content="prog.tex"> 
<meta name="date" content="2017-09-28 14:25:00"> 
<link rel="stylesheet" type="text/css" href="prog.css"> 
</head><body 
>
<!--l. 5864--><div class="crosslinks"><p class="noindent">[<a 
href="progse36.html" >prev</a>] [<a 
href="progse36.html#tailprogse36.html" >prev-tail</a>] [<a 
href="#tailprogse37.html">tail</a>] [<a 
href="progch8.html#progse37.html" >up</a>] </p></div>
<h3 class="sectionHead"><span class="titlemark">8.7   </span> <a 
href="prog.html#QQ2-224-260" id="x224-2380008.7">Memavail and Maxavail</a></h3>
<!--l. 5866--><p class="noindent" >The old Turbo Pascal functions <span 
class="cmtt-10">MemAvail </span>and <span 
class="cmtt-10">MaxAvail </span>functions are no longer available in Free
Pascal as of version 2.0. The reason for this incompatibility is below:
<!--l. 5870--><p class="noindent" >On modern operating systems, <span class="footnote-mark"><a 
href="#fn4x9" id="fn4x9-bk"><sup class="textsuperscript">4</sup></a></span><a 
 id="x224-238001f4"></a>
the idea of &#8221;Available Free Memory&#8221; is not valid for an application. The reasons are:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x224-238003x1">One processor cycle after an application asked the OS how much memory is free,
     another application may have allocated everything.
     </li>
     <li 
  class="enumerate" id="x224-238005x2">It is not clear what &#8221;free memory&#8221; means: does it include swap memory, does it include
     disk cache memory (the disk cache can grow and shrink on modern OS&#8217;es), does it
     include memory allocated to other applications but which can be swapped out, etc.</li></ol>
<!--l. 5884--><p class="noindent" >Therefore, programs using <span 
class="cmtt-10">MemAvail </span>and <span 
class="cmtt-10">MaxAvail </span>functions should be rewritten so they no longer
use these functions, because it does not make sense anymore on modern OS&#8217;es. There are 3
possibilities:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x224-238007x1">Use exceptions to catch out-of-memory errors.
     </li>
     <li 
  class="enumerate" id="x224-238009x2">Set  the  global  variable  &#8221;ReturnNilIfGrowHeapFails&#8221;  to  <span 
class="cmtt-10">True </span>and  check  after  each
     allocation whether the pointer is different from <span 
class="cmtt-10">Nil</span>.
     </li>
     <li 
  class="enumerate" id="x224-238011x3">Don&#8217;t  care  and  declare  a  dummy  function  called  <span 
class="cmtt-10">MaxAvail </span>which  always  returns
     <span 
class="cmtt-10">High(LongInt) </span>(or some other constant).</li></ol>
                                                                            

                                                                            
<div class="footnotes"><!--l. 5872--><p class="noindent" ><span class="footnote-mark"><a 
href="#fn4x9-bk" id="fn4x9"><sup class="textsuperscript">4</sup></a></span><span 
class="cmr-8">The DOS extender GO32V2 falls under this definition of &#8221;modern&#8221; because it can use paged memory and run in</span>
<span 
class="cmr-8">multitasked environments</span>                                                          </div> <!--l. 5900--><div class="crosslinks"><p class="noindent">[<a 
href="progse36.html" >prev</a>]
[<a 
href="progse36.html#tailprogse36.html" >prev-tail</a>] [<a 
href="progse37.html" >front</a>] [<a 
href="progch8.html#progse37.html" >up</a>] </p></div>
<!--l. 5900--><p class="noindent" ><a 
 id="tailprogse37.html"></a>  
</body></html> 
