<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Class types</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,4,png,sections+,fn-in --> 
<meta name="src" content="prog.tex"> 
<meta name="date" content="2017-09-28 14:25:00"> 
<link rel="stylesheet" type="text/css" href="prog.css"> 
</head><body 
>
<!--l. 5234--><div class="crosslinks"><p class="noindent">[<a 
href="progsu168.html" >next</a>] [<a 
href="progsu166.html" >prev</a>] [<a 
href="progsu166.html#tailprogsu166.html" >prev-tail</a>] [<a 
href="#tailprogsu167.html">tail</a>] [<a 
href="progse32.html#progsu167.html" >up</a>] </p></div>
<h4 class="subsectionHead"><span class="titlemark">8.2.13   </span> <a 
href="prog.html#QQ2-211-243" id="x211-2250008.2.13">Class types</a></h4>
<!--l. 5236--><p class="noindent" >Just like objects, classes are stored in memory just as ordinary records with an extra field: a
pointer to the Virtual Method Table (VMT). This field is stored first, and all fields in the class are
stored in the order they are declared.
<!--l. 5241--><p class="noindent" >Contrary to objects, all data fields of a class are always stored in heap memory.
<!--l. 5244--><p class="noindent" >The memory allocated looks as in table (<a 
href="#x211-225001r9">8.9<!--tex4ht:ref: tab:ClassMem --></a>). <div class="table">
                                                                            

                                                                            
<!--l. 5245--><p class="noindent" ><a 
 id="x211-225001r9"></a><hr class="float"><div class="float" 
>
                                                                            

                                                                            
 <div class="caption" 
><span class="id">Table&#x00A0;8.9: </span><span  
class="content">Class memory layout (32/64-bit model)</span></div><!--tex4ht:label?: x211-225001r9 -->
<div class="center" 
>
<!--l. 5245--><p class="noindent" >
<div class="tabular"> <table id="TBL-18" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-18-1g"><col 
id="TBL-18-1"><col 
id="TBL-18-2"><col 
id="TBL-18-3"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-18-1-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-1-1"  
class="td11">Offset</td><td  style="white-space:nowrap; text-align:right;" id="TBL-18-1-2"  
class="td11">     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-18-1-3"  
class="td11">What                                                           </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-18-2-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-2-1"  
class="td11"> 32-bit</td><td  style="white-space:nowrap; text-align:right;" id="TBL-18-2-2"  
class="td11">64-bit</td><td  style="white-space:nowrap; text-align:left;" id="TBL-18-2-3"  
class="td11"></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-18-3-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-3-1"  
class="td11">   +0</td><td  style="white-space:nowrap; text-align:right;" id="TBL-18-3-2"  
class="td11">  +0</td><td  style="white-space:nowrap; text-align:left;" id="TBL-18-3-3"  
class="td11">Pointer to VMT.                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-18-4-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-4-1"  
class="td11">   +4</td><td  style="white-space:nowrap; text-align:right;" id="TBL-18-4-2"  
class="td11">  +8</td><td  style="white-space:nowrap; text-align:left;" id="TBL-18-4-3"  
class="td11">Data. All fields in the order they&#8217;ve been declared.</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-18-5-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-5-1"  
class="td11">     &#x2026;</td><td  style="white-space:nowrap; text-align:right;" id="TBL-18-5-2"  
class="td11">     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-18-6-"><td  style="white-space:nowrap; text-align:right;" id="TBL-18-6-1"  
class="td11">      </td></tr></table></div></div>
                                                                            

                                                                            
</div><hr class="endfloat" />
</div>
<!--l. 5254--><p class="noindent" >The Virtual Method Table (VMT) of each class consists of several fields, which are used for
runtime type information. The VMT layout is illustrated in table (<a 
href="#x211-225002r10">8.10<!--tex4ht:ref: tab:ClassVMTMem --></a>). The VMT is constructed
by the compiler.
<div class="table">
                                                                            

                                                                            
<!--l. 5258--><p class="noindent" ><a 
 id="x211-225002r10"></a><hr class="float"><div class="float" 
>
                                                                            

                                                                            
 <div class="caption" 
><span class="id">Table&#x00A0;8.10: </span><span  
class="content">Class Virtual Method Table memory layout (32/64-bit model)</span></div><!--tex4ht:label?: x211-225002r10 -->
<div class="center" 
>
<!--l. 5258--><p class="noindent" >
<div class="tabular"> <table id="TBL-19" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-19-1g"><col 
id="TBL-19-1"><col 
id="TBL-19-2"><col 
id="TBL-19-3"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-19-1-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-1-1"  
class="td11">Offset</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-1-2"  
class="td11">     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-1-3"  
class="td11">What                                                                                                 </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-19-2-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-2-1"  
class="td11"> 32-bit</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-2-2"  
class="td11">64-bit</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-2-3"  
class="td11"></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-19-3-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-3-1"  
class="td11">   +0</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-3-2"  
class="td11">  +0</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-3-3"  
class="td11">Size of object type data                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-4-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-4-1"  
class="td11">   +4</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-4-2"  
class="td11">  +8</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-4-3"  
class="td11">Minus the size of object type data. Enables determining of valid VMT pointers.</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-5-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-5-1"  
class="td11">   +8</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-5-2"  
class="td11"> +16</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-5-3"  
class="td11">Pointer to ancestor VMT, <span 
class="cmtt-10">Nil </span>if no ancestor available.                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-6-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-6-1"  
class="td11">  +12</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-6-2"  
class="td11"> +24</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-6-3"  
class="td11">Pointer to the class name (stored as a <span 
class="cmtt-10">shortstring</span>).                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-7-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-7-1"  
class="td11">  +16</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-7-2"  
class="td11"> +32</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-7-3"  
class="td11">Pointer to the dynamic method table (using <span 
class="cmtt-10">message </span>with integers).               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-8-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-8-1"  
class="td11">  +20</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-8-2"  
class="td11"> +40</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-8-3"  
class="td11">Pointer to the method definition table.                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-9-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-9-1"  
class="td11">  +24</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-9-2"  
class="td11"> +48</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-9-3"  
class="td11">Pointer to the field definition table.                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-10-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-10-1"  
class="td11">  +28</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-10-2"  
class="td11"> +56</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-10-3"  
class="td11">Pointer to type information table.                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-11-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-11-1"  
class="td11">  +32</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-11-2"  
class="td11"> +64</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-11-3"  
class="td11">Pointer to instance initialization table.                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-12-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-12-1"  
class="td11">  +36</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-12-2"  
class="td11"> +72</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-12-3"  
class="td11">Pointer to the auto table.                                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-13-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-13-1"  
class="td11">  +40</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-13-2"  
class="td11"> +80</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-13-3"  
class="td11">Pointer to the interface table.                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-14-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-14-1"  
class="td11">  +44</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-14-2"  
class="td11"> +88</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-14-3"  
class="td11">Pointer to the dynamic method table (using <span 
class="cmtt-10">message </span>with strings).                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-15-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-15-1"  
class="td11">  +48</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-15-2"  
class="td11"> +96</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-15-3"  
class="td11">Pointer to the <span 
class="cmtt-10">Destroy </span>destructor.                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-16-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-16-1"  
class="td11">  +52</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-16-2"  
class="td11"> +104</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-16-3"  
class="td11">Pointer to the <span 
class="cmtt-10">NewInstance </span>method.                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-17-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-17-1"  
class="td11">  +56</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-17-2"  
class="td11"> +112</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-17-3"  
class="td11">Pointer to the <span 
class="cmtt-10">FreeInstance </span>method.                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-18-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-18-1"  
class="td11">  +60</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-18-2"  
class="td11"> +120</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-18-3"  
class="td11">Pointer to the <span 
class="cmtt-10">SafeCallException </span>method.                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-19-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-19-1"  
class="td11">  +64</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-19-2"  
class="td11"> +128</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-19-3"  
class="td11">Pointer to the <span 
class="cmtt-10">DefaultHandler </span>method.                                                    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-20-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-20-1"  
class="td11">  +68</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-20-2"  
class="td11"> +136</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-20-3"  
class="td11">Pointer to the <span 
class="cmtt-10">AfterConstruction </span>method.                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-21-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-21-1"  
class="td11">  +72</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-21-2"  
class="td11"> +144</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-21-3"  
class="td11">Pointer to the <span 
class="cmtt-10">BeforeDestruction </span>method.                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-22-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-22-1"  
class="td11">  +76</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-22-2"  
class="td11"> +152</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-22-3"  
class="td11">Pointer to the <span 
class="cmtt-10">DefaultHandlerStr </span>method.                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-23-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-23-1"  
class="td11">  +80</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-23-2"  
class="td11"> +160</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-23-3"  
class="td11">Pointer to the <span 
class="cmtt-10">Dispatch </span>method.                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-24-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-24-1"  
class="td11">  +84</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-24-2"  
class="td11"> +168</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-24-3"  
class="td11">Pointer to the <span 
class="cmtt-10">DispatchStr </span>method.                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-25-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-25-1"  
class="td11">  +88</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-25-2"  
class="td11"> +176</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-25-3"  
class="td11">Pointer to the <span 
class="cmtt-10">Equals </span>method.                                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-26-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-26-1"  
class="td11">  +92</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-26-2"  
class="td11"> +184</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-26-3"  
class="td11">Pointer to the <span 
class="cmtt-10">GetHashCode </span>method.                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-27-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-27-1"  
class="td11">  +96</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-27-2"  
class="td11"> +192</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-27-3"  
class="td11">Pointer to the <span 
class="cmtt-10">ToString </span>method.                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-28-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-28-1"  
class="td11"> +100</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-28-2"  
class="td11"> +200</td><td  style="white-space:nowrap; text-align:left;" id="TBL-19-28-3"  
class="td11">Pointers to other virtual methods.                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-19-29-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-29-1"  
class="td11">     &#x2026;</td><td  style="white-space:nowrap; text-align:right;" id="TBL-19-29-2"  
class="td11">     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-19-30-"><td  style="white-space:nowrap; text-align:right;" id="TBL-19-30-1"  
class="td11">      </td></tr></table></div></div>
                                                                            

                                                                            
</div><hr class="endfloat" />
</div>
<!--l. 5292--><p class="noindent" >See the file rtl/inc/objpash.inc for the most current VMT information.
                                                                            

                                                                            
<!--l. 5294--><div class="crosslinks"><p class="noindent">[<a 
href="progsu168.html" >next</a>] [<a 
href="progsu166.html" >prev</a>] [<a 
href="progsu166.html#tailprogsu166.html" >prev-tail</a>] [<a 
href="progsu167.html" >front</a>] [<a 
href="progse32.html#progsu167.html" >up</a>] </p></div>
<!--l. 5294--><p class="noindent" ><a 
 id="tailprogsu167.html"></a>  
</body></html> 
